import React, {useContext} from 'react'
import {Link, NavLink} from "react-router-dom";
import {CurrentUserContext} from 'contexts/currentUser'
import {modalContext} from 'contexts/modalContext'
import SignIn from 'pages/signIn'
import SignUp from 'pages/signUp'
import CitySelect from 'modals/citySelect'
import useLocalStorage from 'hooks/useLocalStorage'

const TopBar = () => {
    const [currentUserState] = useContext(CurrentUserContext)
    const {modalContent, handleModal, modal} = useContext(modalContext)
    const [, setToken] = useLocalStorage('token')

    const handleSignInButton = event => {
        event.preventDefault()
        handleModal(<SignIn/>)
    }

    const handleSignUpButton = event => {
        event.preventDefault()
        handleModal(<SignUp/>)
    }

    const handleSelectCityButton = event => {
        event.preventDefault()
        handleModal(<CitySelect />)
    }

    const handleOutClick = event => {
        setToken(null)
    }

    return (
        <>
            <header>
                <div className="hed_up">
                    <div className="container">
                        <div className="hed_up_item hed_up_logo">
                            <Link to="/"><img src={process.env.PUBLIC_URL + '/img/logo.svg'} alt='Автопортал'/></Link>
                        </div>
                        <a onClick={handleSelectCityButton}>
                            <div className="hed_up_item hed_up_location clickme_town">
                                <span>Уфа</span>
                            </div>
                        </a>
                        <div className="hed_up_item hed_up_menu">
                            <ul>
                                <li><NavLink to={"/"} >Главная</NavLink></li>
                                <li><NavLink to={"/oProekte"}>О проекте</NavLink></li>
                                <li><NavLink to={"/uslovia"}>Условия размещения</NavLink></li>
                                <li><NavLink to={"/razm"}>Как разместиться</NavLink></li>
                                {
                                    currentUserState.isLoggedIn === true && currentUserState.currentUser &&
                                    <>
                                        <li><Link to={"/lk/personal"}>{currentUserState.currentUser.firstName}</Link></li>
                                        <li><a onClick={handleOutClick} href='/'>Выйти</a></li>
                                    </>
                                }
                                {
                                    currentUserState.isLoggedIn === false &&
                                    <>
                                        <li><a onClick={handleSignInButton}>Войти</a></li>
                                        <li><a onClick={handleSignUpButton}>Регистрация</a></li>
                                    </>
                                }
                            </ul>
                        </div>
                    </div>
                </div>


                <div id={'hed_down'} className="hed_down">
                    <div className="container">
                        <ul>
                            <li><NavLink to={"/"} exact activeClassName={"navigationActive"}>Автозапчасти</NavLink></li>
                            <li><NavLink to={"/service"} activeClassName={"navigationActive"}>Автосервисы</NavLink></li>
                            <li><NavLink to={"/setting"} activeClassName={"navigationActive"}>Установка</NavLink></li>
                            <li><NavLink to={"/tuning"} activeClassName={"navigationActive"}>Тюнинг и уход</NavLink></li>
                            <li><NavLink to={"/autorazbori"} activeClassName={"navigationActive"}>Авторазборы</NavLink></li>
                            <li><NavLink to={"/techSupport"} activeClassName={"navigationActive"}>Автотехпомощь</NavLink></li>
                            <li><NavLink to={"/strahovka"} activeClassName={"navigationActive"}>Страхование ТС</NavLink></li>
                            <li><NavLink to={"/jurist"} activeClassName={"navigationActive"}>Автоюристы</NavLink></li>
                        </ul>
                    </div>
                </div>
            </header>
        </>
    )
}

export default TopBar
