import React, {useEffect, useState} from 'react'

const AutoPartItem = ({number, autoParts, setAutoParts}) => {

    const [selectedPartType, setSelectedPartType] = useState(false)
    const [selectedType, setSelectedType] = useState('Все производители')
    const [autoPartTitle, setAutoPartTitle] = useState('')

    useEffect(() => {
        console.log(autoParts)
        console.log(autoParts[number])
        if (autoParts[number] === undefined) {
            return
        }

        const newAutoParts = [...autoParts]
        newAutoParts[number] = {
            autoPartTitle: autoPartTitle,
            autoPartType: selectedType
        }

        setAutoParts(newAutoParts)
    }, [selectedType, autoPartTitle])


    const handleAutoPartType = event => {
        const el = document.getElementById('selectedPartType')
        el.classList.remove('active')
        setSelectedPartType(false)
        setSelectedType(event.target.innerText)
    }

    const handleClickOnSelect = event => {
        if (selectedPartType === false) {
            console.log('handle selected part type')
            setSelectedPartType(true)
            console.log(selectedPartType)
        }
    }

    return (
        <div className="modal_avtozap_item">
            <div className="modal_avtozap_item_num">{number + 1}</div>
            <input
                type="text"
                placeholder="Напишите название запчасти или артикул"
                required={true}
                onChange={event => setAutoPartTitle(event.target.value)}
            />
            <div
                className={
                    selectedPartType === true ?
                        'modal_avtozap_mark modal_avtozap_drop active' : 'modal_avtozap_mark modal_avtozap_drop'
                }
                id='selectedPartType'
            >
                <p
                    onClick={handleClickOnSelect}
                >
                    {selectedType}
                </p>
                <div className="modal_avtozap_drop_box">
                    <div className="modal_avtozap_mycar">
                        <ul>
                            <li onClick={handleAutoPartType}>Все производители</li>
                            <li onClick={handleAutoPartType}>Только оригиналы</li>
                            <li onClick={handleAutoPartType}>Оригиналы и аналоги</li>
                            <li onClick={handleAutoPartType}>Все, кроме Китая</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    )
}

export default AutoPartItem
